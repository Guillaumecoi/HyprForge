{
  description = "Penetration Testing and Security Research Environment";

  inputs = {
    nixpkgs.url = "github:nixos/nixpkgs/nixos-unstable";
    flake-utils.url = "github:numtide/flake-utils";
  };

  outputs =
    { nixpkgs, flake-utils, ... }:
    flake-utils.lib.eachDefaultSystem (
      system:
      let
        pkgs = nixpkgs.legacyPackages.${system};
      in
      {
        devShells.default = pkgs.mkShell {
          buildInputs = with pkgs; [
            # Network scanning
            nmap
            masscan
            zmap

            # Network analysis
            wireshark
            tcpdump
            tshark

            # Web security
            burpsuite
            nikto
            sqlmap

            # Password cracking
            john
            hashcat
            hydra

            # Exploitation frameworks
            metasploit

            # Reverse engineering
            radare2
            ghidra
            binwalk

            # Enumeration
            enum4linux
            gobuster
            feroxbuster
            ffuf

            # Network tools
            netcat
            socat
            proxychains

            # SSL/TLS
            sslscan
            testssl

            # Wireless
            aircrack-ng

            # Scripting and automation
            python3
            python3Packages.pwntools
            python3Packages.scapy
            python3Packages.requests
            python3Packages.beautifulsoup4

            # Information gathering
            theharvester
            whois
            dnsutils

            # Exploitation tools
            exploitdb
            searchsploit

            # Wordlists
            wordlists
            seclists

            # Additional tools
            curl
            wget
            git
            vim
          ];

          shellHook = ''
            echo "üîí Pentesting environment loaded"
            echo "‚ö†Ô∏è  WARNING: Use these tools only on systems you own or have explicit permission to test!"
            echo ""
            echo "üì° Network Scanning: nmap, masscan, zmap"
            echo "üï∏Ô∏è  Web Security: burpsuite, nikto, sqlmap"
            echo "üîì Password Cracking: john, hashcat, hydra"
            echo "üîç Enumeration: gobuster, feroxbuster, ffuf"
            echo "üìä Analysis: wireshark, radare2, ghidra"
            export PROJECT_ROOT=$PWD

            # Set up wordlists location
            export WORDLISTS="${pkgs.seclists}/share/seclists"

            # Create common directories
            mkdir -p scans exploits loot notes

            echo ""
            echo "üìÅ Directories created: scans/, exploits/, loot/, notes/"
            echo "üìö Wordlists available at: $WORDLISTS"
            echo ""
            echo "üí° Quick starts:"
            echo "   nmap -sV -sC <target>"
            echo "   gobuster dir -u <url> -w $WORDLISTS/Discovery/Web-Content/common.txt"
            echo "   searchsploit <service>"
          '';
        };
      }
    );
}
